:host{ display:block; max-width:100%; overflow-x:hidden; box-sizing:border-box; }
*,*::before,*::after{ box-sizing:inherit; }

:host ::ng-deep .cdk-overlay-pane.chat-dialog-panel{ max-width:96vw!important; width:auto!important; overflow-x:hidden!important; }
:host ::ng-deep .chat-dialog-panel .mat-mdc-dialog-surface{ padding:0!important; overflow-x:hidden!important; border-radius:20px!important; }

.chat-wrapper{
  width:clamp(320px, 96vw, 560px);
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;
  box-shadow:0 16px 40px rgba(16,24,40,.14);
  overflow:hidden;
}

.chat-header{
  display:grid; grid-template-columns:44px 1fr 44px; align-items:center;
  padding:12px; border-bottom:1px solid var(--border);
  background:linear-gradient(180deg,#fff 0%, #f7f8ff 100%);
}
.icon-btn{ width:40px;height:40px;border:none;border-radius:12px;cursor:pointer;background:#fff;
  display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(0,0,0,.06); }
.icon-btn.ghost{ background:rgb(238, 73, 73); box-shadow:none; border-radius: 50px;color: white; }
.icon-btn:hover{ background:rgb(241, 118, 118); }

.meta{ display:flex; align-items:center; gap:12px; justify-self:flex-start; }
.meta .avatar{ border-radius:50%; object-fit:cover; display:block; width:40px; height:40px; }
.meta .name{ margin:0; font-size:16px; color:var(--text); line-height:1.1; }
.meta .subtitle{ color:var(--muted); font-size:12px; }

.messages-scroll{
  height:460px; padding:18px; overflow-y:auto; overflow-x:hidden;
  background:
    radial-gradient(900px 400px at -5% -10%, #eef1ff 0%, transparent 45%),
    radial-gradient(900px 400px at 105% -10%, #f5eaff 0%, transparent 45%),
    var(--bg);
}

.state{ height:100px; display:flex; flex-direction:column; gap:6px; align-items:center; justify-content:center; }
.state.muted{ color:var(--muted); } .state.error{ color:#b42318; } .state.empty{ color:var(--muted); }
.state mat-icon{ font-size:28px; }

.msg{ width:100%; display:flex; margin:10px 0; justify-content:flex-start; }
.msg.me{ justify-content:flex-end; }

.bubble{
  position:relative;
  max-width:min(78%, 560px);
  padding:10px 12px;
  background:#ffffff;
  border:1px solid var(--border);
  border-radius:18px;
  box-shadow:0 6px 20px rgba(16,24,40,.08);
  overflow-wrap:anywhere; word-break:break-word;
}
.msg .bubble::after{
  content:''; position:absolute; left:-6px; bottom:0;
  width:12px; height:12px; background:#ffffff;
  border-left:1px solid var(--border); border-bottom:1px solid var(--border);
  border-radius:0 0 0 12px; transform:translateY(50%) rotate(45deg);
}
.msg.me .bubble{
  background:#d2f8c6; border-color:#bdebb3;
}
.msg.me .bubble::after{
  left:auto; right:-6px; background:#d2f8c6; border-left:none; border-bottom:none;
  border-right:1px solid #bdebb3; border-top:1px solid #bdebb3;
}

.content{ margin:0; color:#0f172a; line-height:1.55; font-size:14px; }

.meta-row{ display:flex; align-items:center; gap:8px; justify-content:flex-end; margin-top:6px; }
.time{ font-size:11px; color:#667085; }

.status{ display:inline-flex; align-items:center; color:#94a3b8; }
.status.read{ color:#2196f3; }
.status mat-icon{ font-size:16px; width:16px; height:16px; }

.composer{
  display:grid; grid-template-columns:1fr 52px; gap:10px;
  padding:12px; border-top:1px solid var(--border); background:#fff;
}
.composer input{
  min-width:0;
  border:1px solid var(--border);
  border-radius:22px; padding:12px 14px;
  outline:none; font-size:14px; background:#fff; overflow-x:hidden;
}
.composer input:focus{ border-color:var(--primary); box-shadow:0 0 0 3px rgba(79,70,229,.08); }
.composer button{
  border:none; background:var(--primary); color:#fff;
  width:52px; height:48px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 10px 24px rgba(79,70,229,.25);
}
.composer button:disabled{ opacity:.6; cursor:not-allowed; box-shadow:none; }
.composer button:hover:enabled{ filter:brightness(.95); }
