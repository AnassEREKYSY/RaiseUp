<nav class="navbar">
  <a routerLink="/" class="logo" aria-label="Home">
    <span class="logo-mark">▲</span>
    <span class="logo-text">RaiseUp</span>
  </a>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="search">
    <input
      formControlName="q"
      type="text"
      placeholder="Search startups, investors, industries…"
      aria-label="Search"
    />
    <button type="submit" class="search-btn" aria-label="Search">
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
        <path fill="currentColor"
          d="M21 20.3 16.7 16a7.5 7.5 0 1 0-1.7 1.7L20.3 22 21 20.3ZM10.5 16a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11Z"/>
      </svg>
    </button>
  </form>

  <div class="actions">
    <div class="notif-wrap">
      <button type="button" class="icon-btn ghost" aria-label="Notifications" (click)="openNotifications()">
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path fill="currentColor"
            d="M12 22a2 2 0 0 0 2-2h-4a2 2 0 0 0 2 2Zm6-6V11a6 6 0 1 0-12 0v5l-2 2v1h16v-1l-2-2Z"/>
        </svg>
        <span class="badge" *ngIf="hasNewNotifications"></span>
      </button>

      <div class="notif-panel" *ngIf="open">
        <div class="panel-header">Notifications</div>

        <div class="panel-section">
          <div class="section-title">Match requests</div>
          <div *ngIf="pending.length === 0" class="empty">No pending requests</div>
          <div *ngFor="let m of pending; trackBy: trackById" class="row">
            <div class="msg">
              <div class="type">Match request</div>
              <div class="text">
                From:
                <span class="bold">{{ (m.investorId === user?.id) ? 'You → Startup' : 'Investor → You' }}</span>
              </div>
              <div class="time">{{ m.createdAt | date:'short' }}</div>
            </div>
            <div class="actions">
              <button class="btn" (click)="accept(m)">Accept</button>
              <button class="btn ghost" (click)="reject(m)">Reject</button>
            </div>
          </div>
        </div>

        <div class="panel-section">
          <div class="section-title">All notifications</div>
          <div *ngIf="notifications.length === 0" class="empty">No notifications</div>
          <div *ngFor="let n of notifications; trackBy: trackById" class="row">
            <div class="msg">
              <div class="type">{{ n.type }}</div>
              <div class="text">{{ n.message }}</div>
              <div class="time">{{ n.createdAt | date:'short' }}</div>
            </div>
            <div class="actions">
              <button class="btn" *ngIf="!n.isRead" (click)="markAsRead(n)">Mark read</button>
              <button class="btn ghost" (click)="remove(n)">Clear</button>
            </div>
          </div>
        </div>
      </div>
      <!-- /Panel -->
    </div>

    <button type="button" class="avatar" (click)="goProfile()" aria-label="Profile">
      <img
        *ngIf="user?.avatarUrl; else defaultAvatar"
        [src]="user.avatarUrl"
        alt="Avatar"
      />
      <ng-template #defaultAvatar>
        <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
          <path
            fill="currentColor"
            d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.13-8 4.75V21h16v-2.25C20 16.13 16.42 14 12 14Z"
          />
        </svg>
      </ng-template>
    </button>

    <button type="button" class="icon-btn ghost" (click)="logout()" aria-label="Logout">
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
        <path fill="currentColor"
          d="M10 17v2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h5v2H5v10h5Zm9.59-5-3.3 3.3-1.42-1.42L16.34 13H10v-2h6.34l-1.47-1.47 1.42-1.42L19.59 12Z"/>
      </svg>
    </button>
  </div>
</nav>
